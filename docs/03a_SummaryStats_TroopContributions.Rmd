---
title: "03a_SummaryStats_TroopContributions"
author: "J Andres Gannon and Erin Werner"
date: "August 8, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Load data
```{r}
troops <- readRDS(file = paste0(here::here(), '/data/iiss_afghan.rds'))
```

# Country contribution ratio histogram
```{r}
troops_hist_largebin(troops)
troops_hist_smallbin(troops)
```


# Annual troop contribution bar plot
```{r}
total_troops_per_year(troops)
total_troops_year_mission(troops)
```

# Troops contribution per country
```{r}
country_troop_lineplot(troops)
```

# Troops contribution distribution boxplot
```{r,warning=FALSE}
country_troop_boxplot(troops)
```

# Troops Contribution map
## Year 2001 contributions
```{r}
### Filter to only year 2001 observations that contributed troops
troops_2001 <- subset(troops, year == "2001")
troops_2001 <- subset(troops_2001, troops_afghan_total != "0")

### Raw Troop Contributions
map <- rworldmap::joinCountryData2Map(troops_2001,
                                      nameJoinColumn="country",
                                      joinCode="NAME" )

rworldmap::mapDevice()

mapParams <- rworldmap::mapCountryData(map,
                                       nameColumnToPlot='troops_afghan_total',
                                       catMethod = "pretty",
                                       mapTitle = "Troop Contributions to War in Afghanistan (2001)",
                                       addLegend = FALSE
                                      )

do.call(rworldmap::addMapLegendBoxes,
        c(mapParams,
          horiz = FALSE,
          title = "Troop Contribution",
          cex = 0.9
          )
        )

```

```{r}
### Ratio of contribution to total military
map <- rworldmap::joinCountryData2Map(troops_2001,
                                      nameJoinColumn="country",
                                      joinCode="NAME" )

rworldmap::mapDevice()

mapParams <- rworldmap::mapCountryData(map,
                                       nameColumnToPlot='troops_afghan_ratio',
                                       catMethod = "pretty",
                                       mapTitle = "Troop Contributions Relative to Total Military (2001)",
                                       addLegend = FALSE
                                      )

do.call(rworldmap::addMapLegendBoxes,
        c(mapParams,
          horiz = FALSE,
          title = "Contribution Ratio",
          cex = 0.9
          )
        )

```

```{r}
### Now we scale the variables
troops_2001$troops_afghan_total <- scale(troops_2001$troops_afghan_total)
troops_2001$troops_afghan_ratio <- scale(troops_2001$troops_afghan_ratio)
```

```{r}
### Scaled Raw Troop Contributions
map <- rworldmap::joinCountryData2Map(troops_2001,
                                      nameJoinColumn="country",
                                      joinCode="NAME" )

rworldmap::mapDevice()

mapParams <- rworldmap::mapCountryData(map,
                                       nameColumnToPlot='troops_afghan_total',
                                       catMethod = "pretty",
                                       mapTitle = "Troop Contributions to War in Afghanistan (2001)",
                                       addLegend = FALSE
                                      )

do.call(rworldmap::addMapLegendBoxes,
        c(mapParams,
          horiz = FALSE,
          title = "Scaled Troop Contribution",
          cex = 0.9
          )
        )

```

```{r}
### Scaled Ratio of contribution to total military
map <- rworldmap::joinCountryData2Map(troops_2001,
                                      nameJoinColumn="country",
                                      joinCode="NAME" )

rworldmap::mapDevice()

mapParams <- rworldmap::mapCountryData(map,
                                       nameColumnToPlot='troops_afghan_ratio',
                                       catMethod = "pretty",
                                       mapTitle = "Troop Contributions Relative to Total Military (2001)",
                                       addLegend = FALSE
                                      )

do.call(rworldmap::addMapLegendBoxes,
        c(mapParams,
          horiz = FALSE,
          title = "Scaled Contribution Ratio",
          cex = 0.9
          )
        )

```


